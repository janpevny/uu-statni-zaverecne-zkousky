# 5. Práva v aplikaci a logování

## UseCase profily a autorizace

**UseCase profily a autorizace v aplikaci**

**UseCase profily:**

* **Role-based Access Control (RBAC)** - přiřazení práv na základě rolí uživatelů
* **Attribute-based Access Control (ABAC)** - autorizace na základě atributů uživatele, prostředí a dat
* **Permission-based** - granulární řízení přístupu pomocí jednotlivých oprávnění
* **Policy-based** - definice pravidel pomocí politik a business logiky

**Implementace autorizace:**

* **Middleware/Guards** - kontrola oprávnění před spuštěním akce
* **Decorators/Annotations** - deklarativní označení chráněných metod
* **JWT Claims** - ukládání rolí a oprávnění do tokenů

## Autentizace přes identitu

**Autentizace uživatelů přes externí identity**

**OAuth 2.0/OpenID Connect:**

* **Authorization Server** - centrální služba pro ověřování (Google, Microsoft, Facebook)
* **Access Token** - dočasný token pro přístup k chráněným zdrojům
* **Refresh Token** - dlouhodobý token pro obnovení přístupu
* **PKCE** - Proof Key for Code Exchange pro bezpečnost SPA aplikací

**SAML 2.0:**

* **Identity Provider (IdP)** - poskytovatel identity (AD FS, Azure AD)
* **Service Provider (SP)** - aplikace požadující autentizaci
* **SAML Assertion** - XML dokument s informacemi o uživateli

**Další metody:**

* **LDAP/Active Directory** - podnikové adresářové služby
* **Multi-factor Authentication (MFA)** - kombinace více faktorů ověření

## Hromadná správa uživatelů

**Hromadná správa uživatelů a práv**

**Správa uživatelů:**

* **SCIM (System for Cross-domain Identity Management)** - standardizovaný protokol pro synchronizaci uživatelů
* **Bulk Import/Export** - hromadné operace přes CSV, JSON nebo XML soubory
* **Directory Synchronization** - automatická synchronizace s AD/LDAP
* **Just-in-Time (JIT) Provisioning** - vytvoření účtu při prvním přihlášení

**Správa práv:**

* **Group-based Management** - přiřazení práv pomocí skupin
* **Template-based Roles** - předpřipravené role pro různé pozice
* **Workflow Approval** - schvalovací proces pro změny oprávnění
* **Audit Trail** - sledování všech změn v oprávněních

## Možnosti rozšíření

**Možnosti rozšíření autorizačního systému**

**Architektura rozšíření:**

* **Plugin Architecture** - modulární systém pro přidávání nových autorizačních mechanismů
* **Custom Policy Engines** - vlastní engines pro složité business pravidla
* **External Authorization Services** - integrace s externími službami (Amazon Cognito, Auth0)
* **API-first Approach** - RESTful API pro správu oprávnění

**Škálovatelnost:**

* **Distributed Caching** - Redis/Memcached pro ukládání sessions a oprávnění
* **Microservices Authorization** - dedikované služby pro autentizaci a autorizaci
* **Federated Identity** - spojení více identity providerů

**Pokročilé funkce:**

* **Dynamic Permissions** - oprávnění měnící se podle kontextu
* **Time-based Access** - časově omezený přístup

## Principy logování

**Principy logování v aplikacích**

**Strukturované logování:**

* **JSON Format** - strukturovaný formát pro snadné parsování
* **Correlation ID** - sledování požadavků napříč systémem
* **Contextual Information** - user ID, session ID, timestamp
* **Machine-readable** - formát vhodný pro automatické zpracování

**Výkon a bezpečnost:**

* **Asynchronní logování** - neblokující zápis do logů
* **Log Sampling** - vzorkování pro vysoký throughput
* **PII Sanitization** - odstranění citlivých dat před zápisem
* **Log Encryption** - šifrování citlivých logů

**Standardy:**

* **ISO 27001** - požadavky na bezpečnostní logování
* **GDPR Compliance** - ochrana osobních údajů v lozích

## Úrovně logování

**Úrovně logování a jejich použití**

**Standardní úrovně:**

1. **TRACE** - nejdetailnější informace pro debugging (vstup/výstup z metod)
2. **DEBUG** - detailní informace pro vývojáře (hodnoty proměnných, flow aplikace)
3. **INFO** - obecné informace o běhu aplikace (start/stop, konfigurační změny)
4. **WARN** - upozornění na potenciální problémy (deprecated API, neočekávané hodnoty)
5. **ERROR** - chyby které nevedou k pádu aplikace (validation errors, business exceptions)
6. **FATAL/CRITICAL** - kritické chyby vedoucí k pádu aplikace

**Konfigurace úrovní:**

* **Per-package/module** - různé úrovně pro různé části aplikace
* **Runtime změny** - dynamická změna úrovně bez restartu
* **Environment-specific** - jiné úrovně pro dev/staging/production

## Přístup k logům

**Přístup k logům aplikace**

**Centralizované logování:**

* **ELK Stack** - Elasticsearch, Logstash, Kibana pro agregaci a analýzu
* **Splunk** - komerční platforma pro log management
* **Fluentd/Fluent Bit** - lightweight log collectors
* **Grafana Loki** - horizontálně škálovatelný log aggregation systém

**Cloud řešení:**

* **AWS CloudWatch** - nativní AWS logování a monitoring
* **Azure Monitor** - Microsoft Azure logging služba
* **Google Cloud Logging** - GCP logging infrastruktura

**Bezpečnostní aspekty:**

* **Role-based Access** - řízení přístupu k různým typům logů
* **Audit Logging** - sledování přístupů k logům
* **Log Retention Policies** - automatické mazání starých logů
* **Real-time Alerting** - okamžité upozornění na kritické události

## Monitoring a observabilita

**Monitoring a observabilita aplikací**

**Three Pillars of Observability:**

* **Metrics** - číselné hodnoty v čase (response time, throughput, error rate)
* **Logs** - diskrétní události s kontextem
* **Traces** - sledování požadavků napříč distribuovanými systémy

**Implementační nástroje:**

* **Prometheus + Grafana** - metrics collection a vizualizace
* **Jaeger/Zipkin** - distributed tracing
* **OpenTelemetry** - vendor-neutral observability framework
* **Application Performance Monitoring (APM)** - New Relic, Datadog, Dynatrace

**Klíčové metriky:**

* **Golden Signals** - latency, traffic, errors, saturation
* **SLI/SLO/SLA** - Service Level Indicators/Objectives/Agreements
* **Business Metrics** - conversion rates, user engagement
